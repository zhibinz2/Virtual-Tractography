cd /home/zhibinz2/Documents/GitHub/Virtual-Tractography/ForZhibin/processed_data
load('scale250_Connectome.mat');

superiorfrontal_R=[37:53];
caudalmiddlefrontal_R=[54:58];
precentral_R=[59:74];

superiorfrontal_L=[265:282];
caudalmiddlefrontal_L=[283:288];
precentral_L=[289:309];

LR3motors=[superiorfrontal_R caudalmiddlefrontal_R precentral_R superiorfrontal_L caudalmiddlefrontal_L precentral_L];
LR3motors=[superiorfrontal_R superiorfrontal_L];
LR3motors=[caudalmiddlefrontal_R caudalmiddlefrontal_L];
LR3motors=[precentral_R precentral_L];


fc_bool=logical(fc);
% imagesc(fc);
% imagesc(logical(fc));

motor_ones=zeros(size(fc));
% motor_ones(LR3motors,LR3motors)=1;
motor_ones(LR3motors,:)=1;
motor_ones(:,LR3motors)=1;
% imagesc(motor_ones)
% length(find(motor_ones));
non_motor_ones=~motor_ones;
% imagesc(non_motor_ones)
% imagesc(fc_bool)
fc_bool(find(non_motor_ones))=0;
% imagesc(fc_bool)

[r,c,v]=find(fc_bool);

% all connected ROIs
connected_rois=unique([r;c]);

% plot the sources connected
[bool_a,ind_b] = ismember(source_labels,connected_rois);

% Example
% a = [9 9 8 8 7 7 7 6 6 6 5 5 4 4 2 1 1 1]
% b = [1 1 1 3 3 3 3 3 4 4 4 4 4 9 9 9]
% [lia1,locb1] = ismember(a,b)
% length(lia1)
% length(locb1)

% plot all connected areas to the 3 motor areas
figure;
clf;
scatter3(source_x,source_y,source_z,'g');
hold on;
scatter3(source_x(bool_a),source_y(bool_a),source_z(bool_a),'r.');

%%
x = 0:0.01:1;
p = plot(nan,nan);
p.XData = x;
for n = 1:0.5:5
      p.YData = x.^n;
      exportgraphics(gcf,'testAnimated.gif','Append',true);
end
%% Anymate
% https://www.mathworks.com/matlabcentral/fileexchange/18210-anymate
anymate(@plot,rand(5,5,5), 'Play', true);

[x,y,z]=sphere;
anymate(@surf,{cat(3,x,.2*x+1) cat(3,y,y) cat(3,z,2*z)});
colormap(jet);


%% Create Video of Rotating 3D Plot
% https://www.mathworks.com/matlabcentral/fileexchange/41093-create-video-of-rotating-3d-plot
cd /home/zhibinz2/Documents/GitHub/Virtual-Tractography/ForZhibin/processed_data/video3d_plot/CaptureFigVid/CaptureFigVid



%% git to avi
https://www.mathworks.com/matlabcentral/fileexchange/76198-gif2avi

%% ChatGPT
% Create a figure and specify the filename for the GIF
figure;
filename = 'rotating_3d_plot.gif';

% Set the number of frames and the rotation angles
num_frames = 120;
azimuth_range = linspace(0, 360, num_frames);

for frame = 1:num_frames
    % Create your 3D plot or update your plot here
    % Replace this section with your own plot code
    % Example: Create a simple 3D surface plot
    [X, Y] = meshgrid(linspace(-1, 1, 100), linspace(-1, 1, 100));
    Z = X.^2 + Y.^2;
    surf(X, Y, Z);
    
    % Set the view angle based on the current frame
    view(azimuth_range(frame), 30); % Change 30 to your desired elevation angle
    
    % Capture the frame for the GIF
    frame_data = getframe(gcf);
    
    % Create the GIF or append to it
    if frame == 1
        imwrite(frame_data.cdata, filename, 'gif', 'Loop', Inf, 'DelayTime', 0.1);
    else
        imwrite(frame_data.cdata, filename, 'gif', 'WriteMode', 'append', 'DelayTime', 0.1);
    end
end

%% https://stackoverflow.com/questions/37276645/rotation-increments-are-off-on-3d-object
clf 
[Z,Y,X] = cylinder(10:-1:0, 50);
xlabel('X axis')
ylabel('Y axis')
zlabel('Z axis')
array_sz_begin=size(X);
W=repmat(1,array_sz_begin); %create ones for w
figure(1), clf;surf(X,Y,Z);axis equal;
%--- z-rotation matrix Rz
for n=1:1:45
    th=n*pi/180; %angle of rotation converted to radians;
    Rz=[cos(th) -sin(th) 0 0;sin(th) cos(th) 0 0;0 0 1 0;0 0 0 1];
    P=[X(:) Y(:) Z(:) W(:)]*Rz; %rotate each point on surface
    X=reshape(P(:,1),array_sz_begin);%transform surface vertices back
    Y=reshape(P(:,2),array_sz_begin);
    Z=reshape(P(:,3),array_sz_begin);
    xlabel('X axis')
    ylabel('Y axis')
    zlabel('Z axis')
    clear P;
    title(['Shift in ',num2str(n),' deg']);
    hold on;surf(X,Y,Z);axis equal;
    pause (.5)
end

%% https://www.mathworks.com/matlabcentral/discussions/highlights/741369-new-in-matlab-r2022a-export-graphics-to-animated-gifs

%% https://www.mathworks.com/help/symbolic/writeanimation.html
syms t x
fanimator(@fplot,cos(x)+t,sin(x)+1,[-pi pi])
axis equal
writeAnimation('wheel.gif')
%% https://www.youtube.com/watch?v=joWN32nZRqE (work!)
clear all; close all;

x=1; y=1;
plot(x,y,'*'); axis([0,10,0,10]); grid;

im={}; jj=1; % jj  is the frame number

[im{jj},map]=frame2im(getframe);

jjend=10; % total 10 frames

for jj=2:jjend
    figure(1)
    clf 

    x=x+1; y=y+1;
    plot(x,y,'*');axis([0,10,0,10]);grid;

    [im{jj},map]=frame2im(getframe);

    jj=jj+1;
end

[temp, map]=rgb2ind(im{1},65536); % maximum is 65536

for jj=1:jjend
    gifim(:,:,1,jj)=rgb2ind(im{jj},map);
end

imwrite(gifim,map,'filename.gif');

%%
im={}; jj=1; % jj  is the frame number
[im{jj},map]=frame2im(getframe);
% figure;imagesc(im{1})
jjend=16; % total 16 frames
x=1;y=1;z=1;
theta = linspace(0, 2*pi, 8);
xs=cos(theta);ys=sin(theta);y2s=coszs=sin(theta);
for jj=2:jjend
    figure(1)
    if jj<9
        x=x+1;y=y+1;
        view([xs(x),ys(y),0])
    else
        y
        view([0,ys(y),zs(z)])
    end
    
    
    % view([-1,0,0]) % left side view
    % view([1,0,0]) % right side view
    % view([0 1 0]) % Front view
    % view([0 -1 0]) % Back view
    % view([0 0 1]) % top view
    % rotate3d on
    % rotate3d('on')



